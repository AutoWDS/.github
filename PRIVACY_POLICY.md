# 八爪鱼爬虫插件 - 权限使用说明

本文档详细说明了本插件使用的各项权限及其使用理由，用于浏览器 Web Store 审核提交。

## 单一用途说明

本插件专门用于网页数据采集和爬取，帮助用户从网页中提取结构化数据，支持智能采集和高级采集两种模式，并提供任务管理、定时执行、数据导出等功能。插件仅在用户主动操作时执行数据采集任务，所有采集的数据均存储在用户本地，不会上传到第三方服务器。

---

## 权限使用理由

### 1. alarms（定时任务）

**使用理由：**
- 用于执行用户设置的定时采集任务（Cron 定时任务）
- 当定时任务到达预定时间时，触发通知提醒用户
- 仅在用户主动创建定时任务时使用，用于自动化数据采集流程

**代码位置：** `pages/Background/cron.ts`, `background.ts` (line 67-81)

---

### 2. tabs（标签页管理）

**使用理由：**
- 用于在新标签页中打开网页进行数据采集
- 管理采集任务中的多页面浏览流程
- 获取当前活动标签页信息以注入内容脚本
- 关闭采集任务中打开的临时标签页

**代码位置：** `component/runtime/FlowActionContext.ts`, `background.ts` (line 34-48)

---

### 3. activeTab（活动标签页访问）

**使用理由：**
- 仅在用户点击插件图标或右键菜单时，访问当前活动的标签页
- 用于在当前页面中注入内容脚本，实现智能采集和高级采集功能
- 允许用户在浏览网页时直接对当前页面进行数据提取操作
- 符合最小权限原则，仅在用户主动触发时访问

**代码位置：** `background.ts` (line 34-48), `pages/Content/router.ts`

---

### 4. scripting（脚本注入）

**使用理由：**
- 用于在执行采集任务时，向目标网页注入 JavaScript 脚本
- 实现数据提取、页面交互（点击、滚动、翻页等）功能
- 仅在用户明确创建和执行采集任务时使用
- 不执行任何恶意代码，仅用于数据采集流程

**代码位置：** `component/runtime/FlowActionContext.ts` (line 100-108)

---

### 5. notifications（通知）

**使用理由：**
- 用于定时任务到达时通知用户
- 提醒用户采集任务已开始或需要确认执行
- 提供任务执行状态和结果通知
- 仅在用户设置了定时任务时使用

**代码位置：** `background.ts` (line 70-81, 83-119)

---

### 6. storage（存储）

**使用理由：**
- 用于存储用户的采集任务配置和规则
- 保存用户采集的数据（存储在本地 IndexedDB）
- 保存用户设置、模板配置等信息
- 所有数据仅存储在用户本地，不会上传到外部服务器

**代码位置：** `storage/impl/main-db.ts`, `browser/storage.ts`, `storage/task-service.ts`

---

### 7. contextMenus（右键菜单）

**使用理由：**
- 在网页右键菜单中添加"智能采集"和"高级采集"选项
- 方便用户快速启动数据采集功能
- 仅在 HTTPS 和 HTTP 网页中显示，符合安全要求

**代码位置：** `background.ts` (line 12-49)

---

### 8. unlimitedStorage（无限制存储）

**使用理由：**
- 用户采集的数据量可能很大，需要足够的本地存储空间
- 支持大量采集任务配置和采集结果的本地存储
- 避免因存储配额限制影响用户体验
- 所有数据仅存储在用户本地设备

**代码位置：** `storage/impl/main-db.ts`

---

### 9. declarativeNetRequest（声明式网络请求）

**使用理由：**
- 用于在执行采集任务时，为网络请求添加自定义 HTTP 请求头
- 支持用户配置的请求头（如 User-Agent、Authorization 等）
- 仅在采集任务执行期间临时添加规则，任务结束后自动清除
- 用于模拟浏览器请求，确保采集任务正常执行

**代码位置：** `browser/netRequest.ts`

---

### 10. host_permissions: https://*/*（主机权限）

**使用理由：**
- 用于访问用户指定的网页进行数据采集
- 支持从 HTTPS 网站提取数据
- 仅在用户主动创建和执行采集任务时访问
- 不会在后台自动访问网站，所有访问均为用户触发

**代码位置：** `content.ts`, `component/runtime/FlowActionContext.ts`

---

### 11. web_accessible_resources（网页可访问资源）

**使用理由：**
- 用于在网页中嵌入侧边栏面板（`tabs/panel.html`）
- 提供高级采集的可视化编辑界面
- 允许用户在当前网页中配置数据提取规则
- 仅用于插件功能界面展示，不包含敏感信息

**代码位置：** `tabs/panel.html`, `pages/Panel/AdvancedExtract.tsx`

---

## 数据使用情况

### 数据收集
- 用户创建的任务配置和采集规则（存储在本地）
- 用户采集的数据（存储在本地 IndexedDB）
- 用户设置和偏好配置（存储在本地）

### 数据存储
- 所有数据仅存储在用户本地浏览器中
- 使用 Storage API 和 IndexedDB 进行本地存储
- 不向外部服务器传输任何用户数据

### 数据使用
- 任务配置用于执行数据采集任务
- 采集的数据仅供用户查看和导出
- 用户设置用于个性化插件体验

### 用户账号功能（可选）
- 如果用户选择登录，仅用于同步任务配置到服务器
- 登录凭证存储在本地 Storage 中
- 用户可随时退出登录，数据仍保留在本地

---

## 隐私保护承诺

1. **本地优先：** 所有采集的数据和任务配置默认存储在用户本地，不会自动上传
2. **用户控制：** 用户完全控制何时采集数据、采集哪些数据
3. **最小权限：** 仅请求实现功能所需的最小权限
4. **透明操作：** 所有网络请求和脚本注入均在用户主动触发任务时执行
5. **数据安全：** 不会收集用户的浏览历史、个人隐私信息或与采集任务无关的数据

---

## 远程代码使用说明

本插件不包含任何远程执行的代码。所有代码均在扩展安装包中，执行时无需从外部服务器加载或执行代码。插件使用的所有 JavaScript 代码均为本地代码，确保用户安全和隐私。

---

## 联系方式

如有任何关于隐私和数据使用的疑问，请[联系开发者](mailto:hff1996723@163.com)。

